<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Markdown Editor</title>
<link rel="icon" href="icon.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Lexend:wght@100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Mulish:ital,wght@0,200..1000;1,200..1000&family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Pixelify+Sans:wght@400..700&family=Press+Start+2P&family=Raleway:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&family=Rubik:ital,wght@0,300..900;1,300..900&family=Tiny5&family=VT323&family=Varela+Round&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<style>
body {
  margin:0;
  font-family:'Rubik',sans-serif;
  background:#f5f5f7;
  display:flex;
  flex-direction:column;
  height:100vh;
  overflow:hidden;
  color:#1a1a1a;
}

header {
  background:#111;
  color:#fff;
  padding:12px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header .logo { display:flex; align-items:center; gap:10px;  }
header img { height:22px; }

header nav a {
  color:#fff;
  text-decoration:none;
  margin-right:30px; /* extra spacing */

}
header nav a:last-child { margin-right:0; }
header nav a:hover { text-decoration:underline; }

.toolbar {
  display:flex;
  justify-content:space-between;
  gap:8px;
  padding:8px 12px;
  background:#eaeaea;  
  align-items:center;
  border-bottom:1px solid #ccc;
}

.toolbar-left input {
  padding:6px 10px;
  border-radius:4px;
  border:1px solid #ccc;
  outline:none;
  font-family:'Rubik',sans-serif;
  width:260px;
}

.toolbar-right button {
  background:#111;
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
  font-family:'Rubik',sans-serif;

}
.toolbar-right button:hover { background:#333; }

.editor-container {
  display:flex;
  flex:1;
  height:100%;
  min-height:0;
}

textarea {
  flex:1;
  border:none;
  outline:none;
  resize:none;
  padding:1rem;
  font-family:monospace;
  font-size:1rem;
  background:#fff;
  box-shadow:inset 0 0 0 1px #ddd;
  overflow:auto;
  min-width:0;
  white-space:pre-wrap; /* wrap long lines */
  word-wrap:break-word;
}

.preview {
  flex:1;
  padding:1rem 1.5rem;
  overflow:auto;
  background:#fafafa;
  border-left:1px solid #ddd;
  font-family:"Roboto";
  min-width:0;
  word-wrap:break-word;
  box-sizing:border-box;
}

.divider {
  width:6px;
  background:#ccc;
  cursor:col-resize;
  flex:0 0 auto;
}

.preview h1,.preview h2,.preview h3{margin-top:1.5rem;}
.preview code{background:#eee;padding:0.2em 0.4em;border-radius:4px;word-break:break-word;}
.preview pre{background:#f4f4f4;padding:0.8rem;border-radius:6px;overflow:auto;white-space:pre-wrap;word-wrap:break-word;}
.highlight{background:yellow;padding:0;}

/* Notification */
#notify {
  position:fixed;
  bottom:20px;
  right:20px;
  background:#111;
  color:#fff;
  padding:10px 16px;
  border-radius:6px;
  min-width:150px;
  font-family:'Rubik',sans-serif;
  box-shadow:0 0 10px rgba(0,0,0,0.3);
  display:none;
}
#notify .progress {
  height:2px;
  background:#0f0;
  width:100%;
  margin-top:4px;
  border-radius:1px;
  transition:width 0.05s linear;
}
</style>
</head>
<body>

<header>
  <div class="logo"><img src="icon.png">Markdown Editor</div>
  <nav>
    <a href="https://jamesy-tech.github.io/jamesy-creator">Home</a>
    <a href="https://jamesy-tech.github.io/jamesy-creator/Jamesy%20Creator/index.html?page=apps">Apps</a>
    <a href="https://jamesy-tech.github.io/jamesy-creator/Jamesy%20Creator/index.html?page=profile">Profile</a>
    <a href="https://jamesy-tech.github.io/jamesy-creator/Jamesy%20Creator/index.html?page=settings">Settings</a>
  </nav>
</header>

<div class="toolbar">
  <div class="toolbar-left">
    <input type="text" id="findInput" placeholder="Find...">
  </div>
  <div class="toolbar-right">
    <button onclick="openPreview()">Run</button>
    <button onclick="openFile()">Open</button>
    <button onclick="saveFile()">Save</button>
    <button onclick="downloadFile()">Download</button>
  </div>
</div>

<div class="editor-container">
  <textarea id="editor" spellcheck="false"></textarea>
  <div class="divider" id="divider"></div>
  <div class="preview" id="preview"></div>
</div>

<div id="notify"><span id="notify-text"></span><div class="progress" id="notify-progress"></div></div>

<script>
const editor = document.getElementById('editor');
const preview = document.getElementById('preview');
const findInput = document.getElementById('findInput');
const divider = document.getElementById('divider');
const notify = document.getElementById('notify');
const notifyProgress = document.getElementById('notify-progress');

// Load from localStorage
editor.value = localStorage.getItem('md_content') || '# Welcome to the Markdown Editor\n\nStart typing Markdown...';
updatePreview();

// Update preview
function updatePreview() {
  let html = marked.parse(editor.value);
  const query = findInput.value.trim();
  if(query){
    const regex = new RegExp(query,'gi');
    html = html.replace(regex,m=>`<span class="highlight">${m}</span>`);
  }
  preview.innerHTML = html;

  // Highlight in editor
  if(query){
    const cursor = editor.selectionStart;
    editor.value = editor.value.replace(/\x01/g,''); // reset previous marks
    editor.value = editor.value.replace(new RegExp(query,'gi'),m=>`\x01${m}\x01`);
    editor.selectionStart = cursor;
    editor.selectionEnd = cursor;
  }
}

// Editor input
editor.addEventListener('input',()=>{
  localStorage.setItem('md_content',editor.value);
  updatePreview();
});

// Search input
findInput.addEventListener('input', updatePreview);

// Ctrl shortcuts
window.addEventListener('keydown', e=>{
  const ctrlOrCmd = e.ctrlKey || e.metaKey;
  if(ctrlOrCmd && e.key.toLowerCase()==='f'){e.preventDefault(); findInput.focus();}
  if(ctrlOrCmd && e.key.toLowerCase()==='o'){e.preventDefault();openFile();}
  if(ctrlOrCmd && e.key.toLowerCase()==='s'){e.preventDefault();saveFile();}
});

// Fullscreen preview
function openPreview(){
  const html = marked.parse(editor.value);
  const newTab = window.open();
  newTab.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Preview</title>
      <style>
        body{font-family:Arial,sans-serif;padding:2rem;line-height:1.6;overflow-wrap:break-word;}
        pre{background:#f4f4f4;padding:1rem;border-radius:6px;overflow:auto;white-space:pre-wrap;word-wrap:break-word;}
        code{background:#eee;padding:0.2em 0.4em;border-radius:4px;word-break:break-word;}
      </style>
    </head>
    <body>${marked.parse(editor.value)}</body>
    </html>
  `);
  newTab.document.close();
}

// Download Markdown
function downloadFile(){
  const blob = new Blob([editor.value],{type:'text/markdown'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download='document.md';
  link.click();
}

// Save
function saveFile(){
  localStorage.setItem('md_content',editor.value);
  showNotification('Saved!',3000);
}

// Clear editor
function clearEditor(){
  if(confirm('Clear editor?')){
    editor.value='';
    localStorage.removeItem('md_content');
    updatePreview();
  }
}

// Open file
function openFile(){
  const input=document.createElement('input');
  input.type='file';
  input.accept='.md,.txt';
  input.onchange=e=>{
    const file=e.target.files[0];
    if(!file) return;
    const reader=new FileReader();
    reader.onload=ev=>{
      editor.value=ev.target.result;
      localStorage.setItem('md_content',editor.value);
      updatePreview();
    };
    reader.readAsText(file);
  };
  input.click();
}

// Divider drag
let isResizing=false;
divider.addEventListener('mousedown',()=>{isResizing=true;document.body.style.cursor='col-resize';});
window.addEventListener('mousemove',e=>{
  if(!isResizing) return;
  const container=document.querySelector('.editor-container');
  const offset=e.clientX-container.offsetLeft;
  const totalWidth=container.offsetWidth;
  const percent=Math.max(20,Math.min(80,(offset/totalWidth)*100));
  editor.style.flex=`0 0 ${percent}%`;
  preview.style.flex=`1 0 ${100-percent}%`;
  updatePreview();
});
window.addEventListener('mouseup',()=>{isResizing=false;document.body.style.cursor='';});

// Notification
function showNotification(text,duration){
  notify.style.display='block';
  document.getElementById('notify-text').innerText=text;
  notifyProgress.style.width='100%';
  let start = Date.now();
  const interval = setInterval(()=>{
    let elapsed = Date.now()-start;
    notifyProgress.style.width = `${100-((elapsed/duration)*100)}%`;
    if(elapsed>=duration){
      clearInterval(interval);
      notify.style.display='none';
    }
  },20);
}

// Initial preview
updatePreview();
</script>
</body>
</html>
